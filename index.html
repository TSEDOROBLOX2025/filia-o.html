<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Brookasil RP ‚Äì Sistema</title>

<style>
body {font-family: Arial, sans-serif; background: #eef4f7; margin: 0;}
header {background: #0a7cff; color: #fff; padding: 20px; text-align: center;}
main {max-width: 1200px; margin: auto; padding: 20px;}
.box {background: #fff; padding: 20px; border-radius: 12px; margin-bottom: 25px;}
label {font-weight: bold; display: block; margin-top: 10px;}
input, select, textarea, button {width: 100%; padding: 8px; margin-top: 5px; border-radius:6px; border:1px solid #ccc;}
button {background: #0bb37b; color: #fff; border: none; cursor: pointer;}
button:hover {opacity: 0.9;}
.hidden {display: none;}
table {width: 100%; border-collapse: collapse; margin-top: 10px;}
th, td {border: 1px solid #ccc; padding: 6px; text-align: center;}
th {background: #0a7cff; color: #fff;}
/* Abas */
.tab-buttons {display: flex; gap: 10px; margin-bottom: 20px;}
.tab-buttons button {flex: 1; background: #0a7cff; color: #fff;}
.tab-buttons button.active {background: #0bb37b;}
.tab-content {display: none;}
.tab-content.active {display: block;}
</style>
</head>

<body>
<header><h1>üó≥Ô∏è Brookasil RP</h1></header>
<main>

<div class="tab-buttons">
  <button class="active" onclick="abrirAba('filiacoesTab', this)">üìÑ Filia√ß√µes</button>
  <button onclick="abrirAba('admTab', this)">üîê Painel ADM</button>
  <button onclick="abrirAba('obrasTab', this)">üèóÔ∏è Obras</button>
</div>

<div id="filiacoesTab" class="tab-content active box">
<h2>üìÑ Filia√ß√£o</h2>
<form id="formFiliacao">
<label>Nome completo</label>
<input id="nome" required>

<label>Data de nascimento</label>
<input type="date" id="nascimento" required>

<label>CPF (RP)</label>
<input id="cpf" type="number" inputmode="numeric" required>

<label>TikTok</label>
<input id="tiktok" required>

<label>Zona Eleitoral</label>
<select id="zona" required>
  <option value="">Selecione</option>
  <optgroup label="BH">
    <option>BH-01</option><option>BH-02</option><option>BH-03</option><option>BH-04</option>
    <option>BH-05</option><option>BH-06</option><option>BH-07</option><option>BH-08</option>
    <option>BH-09</option><option>BH-10</option><option>BH-11</option><option>BH-12</option>
    <option>BH-13</option><option>BH-14</option>
  </optgroup>
  <optgroup label="NC">
    <option>NC-01</option><option>NC-02</option><option>NC-03</option><option>NC-04</option>
    <option>NC-05</option><option>NC-06</option><option>NC-07</option><option>NC-08</option>
    <option>NC-09</option><option>NC-10</option><option>NC-11</option>
  </optgroup>
  <optgroup label="CT">
    <option>CT-01</option><option>CT-02</option><option>CT-03</option><option>CT-04</option>
    <option>CT-05</option><option>CT-06</option><option>CT-07</option><option>CT-08</option>
    <option>CT-09</option><option>CT-10</option><option>CT-11</option><option>CT-12</option>
  </optgroup>
  <optgroup label="FM">
    <option>FM-01</option><option>FM-02</option><option>FM-03</option><option>FM-04</option>
    <option>FM-05</option><option>FM-06</option><option>FM-07</option><option>FM-08</option>
    <option>FM-09</option><option>FM-10</option>
  </optgroup>
  <optgroup label="FX">
    <option>FX-01</option><option>FX-02</option><option>FX-03</option><option>FX-04</option>
    <option>FX-05</option><option>FX-06</option><option>FX-07</option><option>FX-08</option>
    <option>FX-09</option><option>FX-10</option><option>FX-11</option><option>FX-12</option>
    <option>FX-13</option><option>FX-14</option>
  </optgroup>
</select>

<label>Lado Pol√≠tico</label>
<select id="lado" required>
<option value="">Selecione</option>
<option>Direita</option>
<option>Centro</option>
<option>Esquerda</option>
</select>

<label>Partido</label>
<select id="partido" required></select>

<label>Pretens√£o de Cargo</label>
<select id="cargoPretendido" required>
<option value="">Selecione a Pretens√£o</option>
<option>Eleitor/Apoiador</option>
<option>Candidato a Vereador</option>
<option>Candidato a Prefeito</option>
<option>Candidato a Deputado</option>
<option>Candidato a Governador</option>
<option>Candidato a Presidente</option>
</select>
<button type="submit">Confirmar</button>
</form>

<h2>üìä Estat√≠sticas</h2>
<table>
<thead><tr><th>Partido</th><th>Total</th></tr></thead>
<tbody id="contadorPartidos"></tbody>
</table>
<table>
<thead><tr><th>Zona</th><th>Total</th></tr></thead>
<tbody id="contadorZonas"></tbody>
</table>
</div>

<div id="admTab" class="tab-content box">
<h2>üîê Painel ADM</h2>
<input type="password" id="senhaAdm" placeholder="Senha">
<button onclick="entrarAdm()">Entrar</button>

<div id="areaAdm" class="hidden">
<p>Total de filia√ß√µes: <b id="total"></b></p>
<table>
<thead>
<tr><th>Nome</th><th>CPF</th><th>Zona</th><th>Partido</th><th>Cargo</th><th>TikTok</th></tr>
</thead>
<tbody id="listaFiliados"></tbody>
</table>
</div>
</div>

<div id="obrasTab" class="tab-content box">
<h2>üèóÔ∏è Registrar Obra</h2>
<select id="cargoObra">
<option value="">Cargo</option>
<option>Prefeito</option>
<option>Governador</option>
<option>Presidente</option>
</select>
<input type="password" id="senhaObra" placeholder="Senha do cargo">
<input id="tituloObra" placeholder="T√≠tulo">
<textarea id="descricaoObra" placeholder="Descri√ß√£o"></textarea>
<input id="localObra" placeholder="Local">
<button onclick="registrarObra()">Registrar</button>

<h2>üìã Obras</h2>
<table>
<thead>
<tr><th>T√≠tulo</th><th>Cargo</th><th>Local</th><th>Descri√ß√£o</th><th>Data</th><th>A√ß√µes</th></tr>
</thead>
<tbody id="listaObras"></tbody>
</table>
</div>

</main>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({databaseURL:"https://filiacao-rp-default-rtdb.firebaseio.com"});
const db = firebase.database();

/* NOVAS VARI√ÅVEIS PARA O CAMPO DE CARGO */
const lado = document.getElementById("lado");
const partido = document.getElementById("partido");
const cargoPretendido = document.getElementById("cargoPretendido");

const partidos = {
  Direita: [
    "PL (22) ‚Äì Partido Liberal", "PP (11) ‚Äì Progressistas", "Republicanos (10) ‚Äì Republicanos",
    "PRTN (75) ‚Äì Partido Republicano Trabalhista Nacional", "Patriota (51) ‚Äì Patriota",
    "PRTB (28) ‚Äì Partido Renovador Trabalhista Brasileiro", "NOVO (30) ‚Äì Partido Novo",
    "PMB (35) ‚Äì Partido da Mulher Brasileira", "DC (27) ‚Äì Democracia Crist√£",
    "UDB (38) ‚Äì Uni√£o da Direita Brookasileira", "Agir (36) ‚Äì Agir", "POL (81) ‚Äì Partido da Ordem e Liberdade",
    "ACN (84) ‚Äì Alian√ßa Crist√£ Nacional", "PRONA (57) ‚Äì Partido da Reedifica√ß√£o da Ordem Nacional",
    "PDC (17) ‚Äì Partido Democrata Crist√£o", "PESP (48) ‚Äì Partido da Esperan√ßa",
    "PMNL (86) ‚Äì Partido Militar Nacionalista"
  ],
  Centro: [
    "MDB (15) ‚Äì Movimento Democr√°tico Brasileiro", "UNI√ÉO (44) ‚Äì Uni√£o Brasil",
    "PSD (55) ‚Äì Partido Social Democr√°tico", "Podemos (20) ‚Äì Podemos",
    "PSDB (45) ‚Äì Partido da Social Democracia Brasileira", "Cidadania (23) ‚Äì Cidadania",
    "Solidariedade (77) ‚Äì Solidariedade", "Avante (70) ‚Äì Avante", "PMN (33) ‚Äì Partido da Mobiliza√ß√£o Nacional",
    "PV (43) ‚Äì Partido Verde", "PUN (42) ‚Äì Partido da Uni√£o Nacional",
    "MPD (37) ‚Äì Movimento Popular Democr√°tico", "PDM (26) ‚Äì Partido da Mudan√ßa",
    "MTB (63) ‚Äì Movimento Trabalhista Brookasileiro", "PTD (46) ‚Äì Partido Trabalhista Democr√°tico",
    "PDSD (88) ‚Äì Partido do Sindicato Democrata", "MSS (14) ‚Äì Partido Miss√£o"
  ],
  Esquerda: [
    "PT (13) ‚Äì Partido dos Trabalhadores", "PSOL (50) ‚Äì Partido Socialismo e Liberdade",
    "PCdoB (65) ‚Äì Partido Comunista do Brasil", "Rede (18) ‚Äì Rede Sustentabilidade",
    "PDT (12) ‚Äì Partido Democr√°tico Trabalhista", "UP (80) ‚Äì Unidade Popular",
    "PCO (29) ‚Äì Partido da Causa Oper√°ria", "PCB (21) ‚Äì Partido Comunista Brasileiro",
    "PSTU (16) ‚Äì Partido Socialista dos Trabalhadores Unificado", "PPL (54) ‚Äì Partido P√°tria Livre",
    "PSB (40) ‚Äì Partido Socialista Brasileiro", "PFS (60) ‚Äì Partido da Frente Socialista",
    "PS (56) ‚Äì Partido Socialista", "PSTN (31) ‚Äì Partido Social Trabalhista Nacional"
  ]
};

lado.onchange = () => {
  partido.innerHTML = "<option value=''>Selecione</option>";
  (partidos[lado.value] || []).forEach(p => partido.innerHTML += `<option>${p}</option>`);
};

/* FILIA√á√ÉO */
formFiliacao.onsubmit = e => {
  e.preventDefault();
  db.ref("filiacoes").push({
    nome: nome.value,
    nascimento: nascimento.value,
    cpf: cpf.value,
    tiktok: tiktok.value,
    zona: zona.value,
    partido: partido.value,
    cargoPretendido: cargoPretendido.value // SALVANDO O NOVO CAMPO
  });
  formFiliacao.reset();
};

/* LEITURA + ESTAT√çSTICAS */
db.ref("filiacoes").on("value", s => {
  const d = s.val() || {};
  let p={}, z={}, totalG=0;
  contadorPartidos.innerHTML="";
  contadorZonas.innerHTML="";
  listaFiliados.innerHTML="";
  Object.values(d).forEach(f=>{
    totalG++;
    p[f.partido]=(p[f.partido]||0)+1;
    z[f.zona]=(z[f.zona]||0)+1;
    // INCLUINDO A COLUNA "CARGO" NO PAINEL ADM
    listaFiliados.innerHTML += `<tr>
      <td>${f.nome}</td><td>${f.cpf}</td><td>${f.zona}</td><td>${f.partido}</td><td>${f.cargoPretendido || 'N/A'}</td><td>${f.tiktok}</td>
    </tr>`;
  });
  for(let k in p) contadorPartidos.innerHTML += `<tr><td>${k}</td><td>${p[k]}</td></tr>`;
  for(let k in z) contadorZonas.innerHTML += `<tr><td>${k}</td><td>${z[k]}</td></tr>`;
  total.textContent = totalG;
});

/* ADM */
let admLogado = false;
function entrarAdm() {
  if(senhaAdm.value === "Brookasil1234") {
    areaAdm.classList.remove("hidden");
    admLogado = true;
  }
}

/* OBRAS */
const SENHAS = {Prefeito:"popo30", Governador:"caiado44", Presidente:"henrique44"};
function registrarObra(){
  if(SENHAS[cargoObra.value] !== senhaObra.value) return alert("Senha errada");
  db.ref("obras").push({
    cargo: cargoObra.value,
    titulo: tituloObra.value,
    descricao: descricaoObra.value,
    local: localObra.value,
    data: new Date().toLocaleDateString("pt-BR")
  });
}

db.ref("obras").on("value", s => {
  listaObras.innerHTML = "";
  Object.entries(s.val() || {}).forEach(([id,o])=>{
    listaObras.innerHTML += `<tr>
      <td>${o.titulo}</td><td>${o.cargo}</td><td>${o.local}</td><td>${o.descricao}</td><td>${o.data}</td>
      <td>${admLogado?`<button onclick="db.ref('obras/${id}').remove()">üóëÔ∏è</button>`:""}</td>
    </tr>`;
  });
});

/* ABAS */
function abrirAba(id, btn){
  document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
  document.querySelectorAll(".tab-buttons button").forEach(b => b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  btn.classList.add("active");
}
</script>
</body>
</html>
