<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brookasil RP | Sistema Eleitoral Oficial</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --gabon-green: #009E60;
            --gabon-yellow: #FCD116;
            --gabon-blue: #3A75C4;
            --glass: rgba(0, 0, 0, 0.8);
            --glass-border: rgba(255, 255, 255, 0.15);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            margin: 0;
            color: white;
            min-height: 100vh;
            background: linear-gradient(135deg, rgba(0,158,96,0.9) 0%, rgba(58,117,196,0.9) 100%),
                        url('https://upload.wikimedia.org/wikipedia/commons/0/04/Flag_of_Gabon.svg');
            background-size: cover, 180px;
            background-attachment: fixed;
        }

        header {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            padding: 50px 20px;
            text-align: center;
            border-bottom: 4px solid var(--gabon-yellow);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        header h1 { margin: 0; font-size: 2.5rem; letter-spacing: 3px; color: var(--gabon-yellow); text-transform: uppercase; }

        main { max-width: 1200px; margin: -30px auto 60px; padding: 0 20px; }

        .tab-buttons { display: flex; gap: 10px; justify-content: center; margin-bottom: 30px; flex-wrap: wrap; }
        .tab-buttons button {
            background: var(--glass); border: 1px solid var(--glass-border); color: white;
            padding: 12px 25px; border-radius: 50px; cursor: pointer; font-weight: 700; transition: 0.3s;
        }
        .tab-buttons button.active { background: var(--gabon-yellow); color: black; box-shadow: 0 0 20px var(--gabon-yellow); transform: scale(1.05); }

        .box { background: var(--glass); backdrop-filter: blur(20px); border-radius: 25px; padding: 35px; border: 1px solid var(--glass-border); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; }
        label { color: var(--gabon-yellow); font-size: 0.75rem; font-weight: 800; text-transform: uppercase; margin-bottom: 5px; display: block; }
        
        input, select, textarea {
            width: 100%; padding: 14px; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border);
            border-radius: 10px; color: white; font-size: 1rem; box-sizing: border-box;
        }
        input:focus, select:focus { border-color: var(--gabon-yellow); outline: none; background: rgba(255,255,255,0.1); }

        .btn-submit {
            background: linear-gradient(90deg, var(--gabon-green), var(--gabon-blue));
            color: white; border: none; padding: 18px; border-radius: 12px; font-weight: 800;
            width: 100%; margin-top: 25px; cursor: pointer; transition: 0.3s;
        }
        .btn-submit:hover { filter: brightness(1.2); transform: translateY(-2px); }

        .table-container { overflow-x: auto; margin-top: 30px; border-radius: 15px; }
        table { width: 100%; border-collapse: collapse; background: rgba(0,0,0,0.3); }
        th { background: var(--gabon-blue); padding: 15px; font-size: 0.8rem; text-transform: uppercase; }
        td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); text-align: center; }

        .badge { background: var(--gabon-green); padding: 4px 10px; border-radius: 6px; font-weight: bold; }
        .hidden { display: none !important; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <h1>üó≥Ô∏è Brookasil RP</h1>
    <p>Tribunal Superior Eleitoral - Gabinete Governamental</p>
</header>

<main>
    <div class="tab-buttons">
        <button class="active" onclick="abrirAba('filiacoesTab', this)">üìÑ Filia√ß√µes</button>
        <button onclick="abrirAba('obrasTab', this)">üèóÔ∏è Mural de Obras</button>
        <button onclick="abrirAba('admTab', this)">üîê Painel ADM</button>
    </div>

    <div id="filiacoesTab" class="tab-content active box">
        <h2>Ficha de Filia√ß√£o Oficial</h2>
        <form id="formFiliacao">
            <div class="form-grid">
                <div><label>Nome Completo</label><input id="nome" required></div>
                <div><label>Passaporte (CPF do RP)</label><input id="cpf" type="number" required></div>
                <div><label>TikTok</label><input id="tiktok" required></div>
                <div><label>Data Nascimento</label><input type="date" id="nascimento" required></div>
                
                <div>
                    <label>Zona Eleitoral</label>
                    <select id="zona" required>
                        <option value="">Selecione a Zona</option>
                        <optgroup label="BH (Brookhaven)">
                            <option>BH-01</option><option>BH-02</option><option>BH-03</option><option>BH-04</option><option>BH-05</option><option>BH-06</option><option>BH-07</option>
                            <option>BH-08</option><option>BH-09</option><option>BH-10</option><option>BH-11</option><option>BH-12</option><option>BH-13</option><option>BH-14</option>
                        </optgroup>
                        <optgroup label="NC (Novacore)">
                            <option>NC-01</option><option>NC-02</option><option>NC-03</option><option>NC-04</option><option>NC-05</option><option>NC-06</option>
                            <option>NC-07</option><option>NC-08</option><option>NC-09</option><option>NC-10</option><option>NC-11</option>
                        </optgroup>
                        <optgroup label="CT (Caster√≠ber)">
                            <option>CT-01</option><option>CT-02</option><option>CT-03</option><option>CT-04</option><option>CT-05</option><option>CT-06</option>
                            <option>CT-07</option><option>CT-08</option><option>CT-09</option><option>CT-10</option><option>CT-11</option><option>CT-12</option>
                        </optgroup>
                        <optgroup label="FM (Fortemega)">
                            <option>FM-01</option><option>FM-02</option><option>FM-03</option><option>FM-04</option><option>FM-05</option>
                            <option>FM-06</option><option>FM-07</option><option>FM-08</option><option>FM-09</option><option>FM-10</option>
                        </optgroup>
                        <optgroup label="FX (Flor√™mix)">
                            <option>FX-01</option><option>FX-02</option><option>FX-03</option><option>FX-04</option><option>FX-05</option><option>FX-06</option><option>FX-07</option>
                            <option>FX-08</option><option>FX-09</option><option>FX-10</option><option>FX-11</option><option>FX-12</option><option>FX-13</option><option>FX-14</option>
                        </optgroup>
                    </select>
                </div>

                <div>
                    <label>Espectro Pol√≠tico</label>
                    <select id="lado" required>
                        <option value="">Selecione</option>
                        <option value="Direita">Direita</option>
                        <option value="Centro">Centro</option>
                        <option value="Esquerda">Esquerda</option>
                    </select>
                </div>

                <div><label>Partido</label><select id="partido" required></select></div>
                
                <div>
                    <label>Cargo Pretendido</label>
                    <select id="cargoPretendido" required>
                        <option>Eleitor/Apoiador</option><option>Vereador</option><option>Prefeito</option><option>Deputado Federal</option><option>Deputado Estadual</option></option></option><option>Senador</option><option>Presidente</option>
                    </select>
                </div>
            </div>
            <button type="submit" class="btn-submit">CONFIRMAR REGISTRO</button>
        </form>

        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:25px; margin-top:40px;">
            <div class="table-container"><h3>üìä Estat√≠sticas Partid√°rias</h3><table><thead><tr><th>Sigla</th><th>Total</th></tr></thead><tbody id="contadorPartidos"></tbody></table></div>
            <div class="table-container"><h3>üìç Zonas Populosas</h3><table><thead><tr><th>Zona</th><th>Total</th></tr></thead><tbody id="contadorZonas"></tbody></table></div>
        </div>
    </div>

    <div id="obrasTab" class="tab-content box">
        <h2>üèóÔ∏è Mural Governamental</h2>
        <div class="form-grid">
            <select id="cargoObra"><option>Prefeito</option><option>Governador</option><option>Senador</option><option>Presidente</option></select>
            <input type="password" id="senhaObra" placeholder="Senha Governamental">
            <input id="tituloObra" placeholder="T√≠tulo da Obra">
            <input id="localObra" placeholder="Local">
        </div>
        <textarea id="descricaoObra" placeholder="Descri√ß√£o da obra..." style="margin-top:15px; height:80px"></textarea>
        <button onclick="registrarObra()" class="btn-submit">PUBLICAR OBRA</button>
        <div class="table-container"><table><thead><tr><th>Obra</th><th>Autoridade</th><th>Local</th><th>Data</th><th id="colAcaoObra" class="hidden">A√ß√£o</th></tr></thead><tbody id="listaObras"></tbody></table></div>
    </div>

    <div id="admTab" class="tab-content box">
        <h2>üîê Painel ADM</h2>
        <div id="loginAdm" style="display: flex; gap:10px;"><input type="password" id="senhaAdm" placeholder="Senha Master"><button onclick="entrarAdm()" class="btn-submit" style="margin:0; width:150px">ENTRAR</button></div>
        <div id="areaAdm" class="hidden">
            <p>Total de Filiados: <span class="badge" id="total">0</span></p>
            <div class="table-container"><table><thead><tr><th>Nome</th><th>Zona</th><th>Partido</th><th>TikTok</th><th>A√ß√£o</th></tr></thead><tbody id="listaFiliados"></tbody></table></div>
        </div>
    </div>
</main>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({databaseURL: "https://filiacao-rp-default-rtdb.firebaseio.com"});
const db = firebase.database();

const partidosMap = {
  Direita: [
    "PL (22) - Partido Liberal",
    "PP (11) - Progressistas",
    "Republicanos (10)",
    "PRTN (75) - Partido Republicano Trabalhista Nacional",
    "Patriota (51)",
    "PRTB (28) - Partido Renovador Trabalhista Brasileiro",
    "NOVO (30)",
    "PMB (35) - Partido da Mulher Brasileira",
    "DC (27) - Democracia Crist√£",
    "UDB (38) - Uni√£o da Direita Brookasileira",
    "Agir (36)",
    "POL (81) - Partido da Ordem e Liberdade",
    "ACN (84) - Alian√ßa Crist√£ Nacional",
    "PRONA (57) - Partido da Reedifica√ß√£o da Ordem Nacional",
    "PSL (17) - Partido Social Liberal",
    "PESP (48) - Partido da Esperan√ßa",
    "PMNL (86) - Partido Militar Nacionalista"
  ],
  Centro: [
    "MDB (15) - Movimento Democr√°tico Brasileiro",
    "UNI√ÉO (44) - Uni√£o Brasil",
    "PSD (55) - Partido Social Democr√°tico",
    "Podemos (20)",
    "PSDB (45) - Partido da Social Democracia Brasileira",
    "Cidadania (23)",
    "Solidariedade (77)",
    "Avante (70)",
    "PMN (33) - Partido da Mobiliza√ß√£o Nacional",
    "PV (43) - Partido Verde",
    "PUN (42) - Partido da Uni√£o Nacional",
    "MPD (37) - Movimento Popular Democr√°tico",
    "PDM (26) - Partido da Mudan√ßa",
    "MTB (63) - Movimento Trabalhista Brookasileiro",
    "PTD (46) - Partido Trabalhista Democr√°tico",
    "PDSD (88) - Partido do Sindicato Democrata",
    "MSS (14) - Partido Miss√£o"
  ],
  Esquerda: [
    "PT (13) - Partido dos Trabalhadores",
    "PSOL (50) - Partido Socialismo e Liberdade",
    "PCdoB (65) - Partido Comunista do Brasil",
    "Rede (18) - Rede Sustentabilidade",
    "PDT (12) - Partido Democr√°tico Trabalhista",
    "UP (80) - Unidade Popular",
    "PCO (29) - Partido da Causa Oper√°ria",
    "PCB (21) - Partido Comunista Brasileiro",
    "PSTU (16) - Partido Socialista dos Trabalhadores Unificado",
    "PPL (54) - Partido P√°tria Livre",
    "PSB (40) - Partido Socialista Brasileiro",
    "PFS (60) - Partido da Frente Socialista",
    "PS (56) - Partido Socialista",
    "PSTN (31) - Partido Social Trabalhista Nacional"
  ]
};

document.getElementById("lado").onchange = function() {
    const pSel = document.getElementById("partido");
    pSel.innerHTML = "<option value=''>Selecione o Partido</option>";
    (partidosMap[this.value] || []).forEach(p => pSel.innerHTML += `<option value="${p}">${p}</option>`);
};

// SUBMISS√ÉO COM LIMPEZA DE DUPLICADOS (NOME + TIKTOK)
document.getElementById("formFiliacao").onsubmit = e => {
    e.preventDefault();
    const nome = document.getElementById("nome").value;
    const tiktok = document.getElementById("tiktok").value;

    db.ref("filiacoes").once("value", snap => {
        const data = snap.val();
        if(data) {
            Object.entries(data).forEach(([id, r]) => {
                if(r.nome === nome && r.tiktok === tiktok) db.ref(`filiacoes/${id}`).remove();
            });
        }
        db.ref("filiacoes").push({
            nome, tiktok, 
            cpf: document.getElementById("cpf").value,
            nascimento: document.getElementById("nascimento").value,
            zona: document.getElementById("zona").value,
            partido: document.getElementById("partido").value,
            cargoPretendido: document.getElementById("cargoPretendido").value
        }).then(() => { alert("Sucesso!"); document.getElementById("formFiliacao").reset(); });
    });
};

// SINCRONIZA√á√ÉO
db.ref("filiacoes").on("value", s => {
    const data = s.val() || {};
    const lista = document.getElementById("listaFiliados");
    let pCount = {}, zCount = {}, tot = 0;
    lista.innerHTML = "";
    Object.entries(data).forEach(([id, f]) => {
        tot++;
        pCount[f.partido] = (pCount[f.partido] || 0) + 1;
        zCount[f.zona] = (zCount[f.zona] || 0) + 1;
        lista.innerHTML += `<tr><td>${f.nome}</td><td>${f.zona}</td><td>${f.partido}</td><td>${f.tiktok}</td><td><button onclick="db.ref('filiacoes/${id}').remove()" style="color:red; background:none; border:none; cursor:pointer">X</button></td></tr>`;
    });
    document.getElementById("total").textContent = tot;
    document.getElementById("contadorPartidos").innerHTML = Object.entries(pCount).map(([k,v]) => `<tr><td>${k}</td><td><span class="badge">${v}</span></td></tr>`).join("");
    document.getElementById("contadorZonas").innerHTML = Object.entries(zCount).map(([k,v]) => `<tr><td>${k}</td><td><span class="badge" style="background:var(--gabon-blue)">${v}</span></td></tr>`).join("");
});

const SENHAS = {Prefeito:"popo30", Governador:"caiado44", Senador:"senado2024", Presidente:"henrique44"};
function registrarObra() {
    const c = document.getElementById("cargoObra").value;
    if(SENHAS[c] !== document.getElementById("senhaObra").value) return alert("Erro");
    db.ref("obras").push({ cargo: c, titulo: document.getElementById("tituloObra").value, local: document.getElementById("localObra").value, descricao: document.getElementById("descricaoObra").value, data: new Date().toLocaleDateString("pt-BR") });
}

db.ref("obras").on("value", s => {
    const list = document.getElementById("listaObras");
    list.innerHTML = "";
    Object.entries(s.val() || {}).forEach(([id, o]) => {
        list.innerHTML += `<tr><td><b>${o.titulo}</b><br><small>${o.descricao}</small></td><td>${o.cargo}</td><td>${o.local}</td><td>${o.data}</td>${admLogado ? `<td><button onclick="db.ref('obras/${id}').remove()">X</button></td>` : ""}</tr>`;
    });
});

let admLogado = false;
function entrarAdm() {
    if(document.getElementById("senhaAdm").value === "Brookasil1234") {
        admLogado = true;
        document.getElementById("loginAdm").classList.add("hidden");
        document.getElementById("areaAdm").classList.remove("hidden");
        document.getElementById("colAcaoObra").classList.remove("hidden");
    }
}
function abrirAba(id, btn) {
    document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
    document.querySelectorAll(".tab-buttons button").forEach(b => b.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    btn.classList.add("active");
}
</script>
</body>
</html>
